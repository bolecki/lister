{% extends 'lists/base.html' %}

{% load staticfiles %}

{% block title %}{{ lister }}{% endblock %}

{% block startscript %}
function update(id, action){
  var url = "{% url 'lists:vote' list_id=list_id item_id=12345 action='abcdef' %}";

  url = url.replace('12345', id);
  url = url.replace('abcdef', action);

  $.post(url, function(data){
    $("#lister-items").html(data);
  });
}
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>{{ lister }}   <button class="btn btn-xs btn-warning" type="button" id="toggle-edit">Edit</button></h1>
</div>

<div class="row">
    <div class="col-lg-3 col-md-6">
        <h4 id="selected"></h4>
    </div>
</div>

<div class="row" id="lister-items">
Loading...
</div>

<script src="{% static 'lists/sortable.min.js' %}"></script>

{% endblock %}

{% block endscript %}
$(document).ready(function(){
  $.get("{% url 'lists:part' list_id=list_id %}", function(data){
    $("#lister-items").html(data);
  });

  $("#toggle-edit").click(function(){
    if($("#toggle-edit").html() == 'Edit'){
      $(".edit").show(400);
      $("#toggle-edit").html("Stop Editing");
    }else{
      $(".edit").hide(400);
      $("#toggle-edit").html("Edit");
    }
  });

  (function poll() {
    setTimeout(function() {
      $.ajax({ url: "{% url 'lists:part' list_id=list_id %}", success: function(data) {
        $("#lister-items").html(data);
      }, complete: poll });
    }, 10000);
  })();

});
{% endblock %}
